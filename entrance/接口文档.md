#   目录
[TOC]

#   前言
>   本文由银行开发人员提供

>   ==接口联调事宜，请提供四项基本信息：  
>   1.请求URL，   
>   2.请求参数（JSON数据），    
>   3.加密拼接字符串，  
>   4.错误码以及错误描述==

>   ==一切解释最终权归银行开发者所有==

#   1.  版本管理
#   2.  数据交互（JSON数据流）
##  2.1 提交数据

采用HTTP标准的POST协议，为了保证接收方接收数据正确,传输数据必须签名。
```Json
{
    "attach": "附加信息",
    "body": "商品信息标题",
    "mch_id": "C123456789",
    "nonce_str": "random123",
    "notify_url": "http://pay.weixin.qq.com",
    "out_trade_no": "O12345678",
    "service_type": "WECHAT_SCANNED",
    "total_fee": "1",
    "sign": "signXXXXXXX"
}
```
##  2.2 返回数据

业务处理成功-返回数据：
```
{
    "return_code": "SUCCESS",
    "return_msg": "成功",
    "sign": "signXXXXXXX",
    "mch_id": "C123456789",
    "nonce_str": "random123",
    "trade_type": "WECHAT_SCANNED",
    "code_url": "weixin://payxxxxxxxxx"
}
```
业务处理失败-返回数据：
```
{
    "return_code": "ERROR_CODE",
    "return_msg": "Sign error",
    "sign": "signXXXXXXX"
}
```

一般有返回有`return_code`参数，`SUCCESS`表示调用成功；`非SUCCESS`表示调用失败；个别接口成功返回值为`000000`。


#   3.  签名算法（MD5）
#   4. 业务接口
##  4.0 代理商
业务|地址
---|---
代理商入件| 测试环境暂不支持入件，但可以调试接口连通性
测试环境地址(请以此为准)|http://bjrcb-test.291501.com
http://bjrcb-pay-test.xianyizu.com/
    

##  4.1 商户
>   测试代理商：     D149628212021333015    
>   测试代理商密钥： 6ec855f4ff854c069a6d457748236d80

业务 | 版本|加签密钥|异步通知| 
---|---|---|---|
商户进件|V1.0.1|代理商密钥|
商户查询|V1.0.0|代理商密钥|
商户修改|V1.0.0|代理商密钥|
商户微信-公众号配置|V1.0.0|代理商密钥|
商户T0结算|V1.0.1|商户密钥|
商户T0结算查询|V1.0.0|商户密钥|
对账单下载|V1.0.0|代理商密钥|
卡bin信息查询|V1.0.0|代理商密钥|
经营行业列表|V1.0.0||

##  4.2 微信
>   测试商户：  S149628461779633015
>   测试商户密钥：cNXuuqhUCPHv2tIZCvzPukAU3VYLzwre

业务|版本|异步通知
---|---|---
微信-扫码支付|V1.0.2|是
微信-条码（收付款）|V1.0.2|
微信-公众号|V1.0.3|是
微信-APP|V1.0.0|是
微信-异步通知|V1.0.0|
微信-订单查询|V1.0.0|
微信-关单|V1.0.0|
微信-撤销|V1.0.0|
微信-退款|V1.0.0|

##  4.3 支付宝
>   测试商户：  S149628461779633015
>   测试商户密钥：cNXuuqhUCPHv2tIZCvzPukAU3VYLzwre

==注：（支付宝接入测试请使用沙箱环境进行测试，支付宝为保证沙箱长期稳定，每周日中午12点至每周一中午12点沙箱环境进行维护，期间可能出现不可用，敬请谅解。）==

[点击获取支付宝沙箱环境](https://openhome.alipay.com/platform/appDaily.htm?tab=account)   
>   软件获取: 支付宝开放平台 -> 开发者中心 -> 研发服务 -> 沙箱环境 -> 沙箱应用 

>   账号获取: 支付宝开放平台 -> 开发者中心 -> 研发服务 -> 沙箱环境 -> 沙箱账号

业务|版本|异步通知
---|---|---
支付宝-扫码|V1.0.1|是
支付宝-条码（付钱）|V1.0.1|
支付宝-订单查询|V1.0.0|
支付宝-服务窗|V1.0.0|是
支付宝-异步通知|V1.0.0|
支付宝-退款|V1.0.0|
支付宝-撤销|V1.0.0|

#   5.  注意事项
1.  所有涉及到金额的单位都是分，最小的单位是 1 分，不能有小数出现
2.  notify_url 是银行服务器从后台直接发起请求到商户服务器，商户处理时不能检查用户的 cookie 或 session；
商户更新 DB 等发货流程需要在 notify_url 完成后，以确保掉单时，银行补单能成功补上
3.  notify_url 有可能重复通知，商户需要做去重处理，避免多次发货
4.  notify_url 收到的通知，商户处理成功或检查订单已经处理，需要返回处理成功的标志“SUCCESS”，以告知
银行不再通知
5.  其它注意事项
    1.  参数大小写问题请留意文档中要求的字符大小写问题， 如 “md5 运算后， 字符串的字符要转换为大写” 。
    2.  参数格式问题所有传入参数，均为字符串类型，请注意文档中各处的具体要求。
    3.  时间戳问题请使用 Linux 时间戳，注意为字符串格式。精确到秒，不需要到毫秒，即 10 位数字。==涉及到时间的都是24小时制==
    4.  同一商户订单号支付问题
        1.  商户的 out_trade_no 必须全局唯一，调试和生产环境，都需要使用唯一的订单号
        2.  注意：当商户的同一个商户号绑定了多种支付方式也需要加标识来区分，不能出现重复。当发起支付返回失败时，一定要用原订单的 out_trade_no 而不能重新生成新的订单号发起支付，避免同一单重复支付。
